# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∏ –¥–æ—Å—Ç—É–ø–æ–º –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

## –î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞
2025-01-27

## –ö–æ–Ω—Ç–µ–∫—Å—Ç
–ü–æ—Å–ª–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è –¥–Ω–µ–π —Ä–æ–∂–¥–µ–Ω–∏—è, –∑–∞–ø—Ä–æ—Å—ã PUT/DELETE –≤—Å—ë –µ—â—ë –Ω–µ –¥–æ—Ö–æ–¥—è—Ç –¥–æ backend middleware (–Ω–µ—Ç –ª–æ–≥–æ–≤ `[REQUEST]`). –≠—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä–æ–±–ª–µ–º—É, –≤–æ–∑–Ω–∏–∫–∞—é—â—É—é –î–û —Ç–æ–≥–æ, –∫–∞–∫ –∑–∞–ø—Ä–æ—Å –ø–æ–ø–∞–¥–∞–µ—Ç –≤ FastAPI.

## –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê #1: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –ë–î –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `backend/src/presentation/web/routes/api.py` - endpoints `update_birthday` –∏ `delete_birthday`

**–ü—Ä–æ–±–ª–µ–º–∞**:
–í endpoints `update_birthday` –∏ `delete_birthday` –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¢–†–ò —Ä–∞–∑–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –ë–î:

1. **–°–µ—Å—Å–∏—è #1**: –°–æ–∑–¥–∞—ë—Ç—Å—è –≤ `require_panel_access` —á–µ—Ä–µ–∑ `get_readonly_use_case_factory()`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–Ω–µ–ª–∏
   - –°–æ–∑–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ `db.get_session()` –≤ `get_readonly_use_case_factory`

2. **–°–µ—Å—Å–∏—è #2**: –°–æ–∑–¥–∞—ë—Ç—Å—è –≤ `get_use_case_factory` —á–µ—Ä–µ–∑ `get_db_session()`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–±—Ä–∏–∫–∏ use-cases
   - –°–æ–∑–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ `db.get_session()` –≤ `get_use_case_factory`

3. **–°–µ—Å—Å–∏—è #3**: –°–æ–∑–¥–∞—ë—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ `get_db_session()`
   - –ü–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ endpoint –∫–∞–∫ `session: AsyncSession`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è `session.commit()`

**–ö–æ–¥ –ø—Ä–æ–±–ª–µ–º—ã**:
```python
@router.put("/api/panel/birthdays/{birthday_id}")
async def update_birthday(
    request: Request,
    birthday_id: int = Path(...),
    data: BirthdayUpdate = Body(...),
    session: AsyncSession = Depends(get_db_session),  # –°–µ—Å—Å–∏—è #3
    user: dict = Depends(require_panel_access),       # –°–æ–∑–¥–∞—ë—Ç —Å–µ—Å—Å–∏—é #1 –≤–Ω—É—Ç—Ä–∏
    factory: UseCaseFactory = Depends(get_use_case_factory),  # –°–æ–∑–¥–∞—ë—Ç —Å–µ—Å—Å–∏—é #2
):
    # ...
    await session.commit()  # –ö–æ–º–º–∏—Ç–∏—Ç —Å–µ—Å—Å–∏—é #3, –Ω–æ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –≤ —Å–µ—Å—Å–∏–∏ #2!
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**:
- –û–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ –æ–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏, –∞ –∫–æ–º–º–∏—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –¥—Ä—É–≥–æ–π
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ—Ç–µ—Ä—è–Ω—ã
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –Ω–∞—Ä—É—à–µ–Ω–∞
- –í–æ–∑–º–æ–∂–Ω—ã race conditions

**–†–µ—à–µ–Ω–∏–µ**:
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É —Å–µ—Å—Å–∏—é –¥–ª—è –≤—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞. –ò–∑–º–µ–Ω–∏—Ç—å `require_panel_access` —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω –ø—Ä–∏–Ω–∏–º–∞–ª —Å–µ—Å—Å–∏—é –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä, –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

---

### üü° –ü–†–û–ë–õ–ï–ú–ê #2: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π FastAPI

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `backend/src/presentation/web/routes/api.py` - endpoints `update_birthday` –∏ `delete_birthday`

**–ü—Ä–æ–±–ª–µ–º–∞**:
FastAPI —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –ø–æ—Ä—è–¥–∫–µ –∏—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏—è. –¢–µ–∫—É—â–∏–π –ø–æ—Ä—è–¥–æ–∫:
1. `session: AsyncSession = Depends(get_db_session)` - —Å–æ–∑–¥–∞—ë—Ç —Å–µ—Å—Å–∏—é #3
2. `user: dict = Depends(require_panel_access)` - —Å–æ–∑–¥–∞—ë—Ç —Å–µ—Å—Å–∏—é #1 –≤–Ω—É—Ç—Ä–∏
3. `factory: UseCaseFactory = Depends(get_use_case_factory)` - —Å–æ–∑–¥–∞—ë—Ç —Å–µ—Å—Å–∏—é #2

–ù–æ `get_use_case_factory` –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `get_db_session`, –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ —Å–æ–∑–¥–∞–ª —Å–µ—Å—Å–∏—é #3. –û–¥–Ω–∞–∫–æ FastAPI —Å–æ–∑–¥–∞—ë—Ç –ù–û–í–£–Æ —Å–µ—Å—Å–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ `Depends(get_db_session)`.

**–†–µ—à–µ–Ω–∏–µ**:
–ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Ç–∞–∫, —á—Ç–æ–±—ã `session` —Å–æ–∑–¥–∞–≤–∞–ª—Å—è –ø–µ—Ä–≤—ã–º, –∞ –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –≤–µ–∑–¥–µ:
```python
async def update_birthday(
    request: Request,
    birthday_id: int = Path(...),
    data: BirthdayUpdate = Body(...),
    session: AsyncSession = Depends(get_db_session),  # –°–Ω–∞—á–∞–ª–∞ —Å–µ—Å—Å–∏—è
    factory: UseCaseFactory = Depends(get_use_case_factory),  # –§–∞–±—Ä–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—É –∂–µ —Å–µ—Å—Å–∏—é
    user: dict = Depends(require_panel_access),  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—É –∂–µ —Å–µ—Å—Å–∏—é
):
```

–ù–æ –¥–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å `require_panel_access` –∏ `get_readonly_use_case_factory`, —á—Ç–æ–±—ã –æ–Ω–∏ –ø—Ä–∏–Ω–∏–º–∞–ª–∏ —Å–µ—Å—Å–∏—é –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä.

---

### üü° –ü–†–û–ë–õ–ï–ú–ê #3: `get_readonly_use_case_factory` —Å–æ–∑–¥–∞—ë—Ç —Å–≤–æ—é —Å–µ—Å—Å–∏—é

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `backend/src/presentation/web/dependencies.py`

**–ü—Ä–æ–±–ª–µ–º–∞**:
`get_readonly_use_case_factory()` –≤—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é, –¥–∞–∂–µ –µ—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è —Å–µ—Å—Å–∏—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∑–∞–ø—Ä–æ—Å–∞.

**–ö–æ–¥**:
```python
async def get_readonly_use_case_factory() -> UseCaseFactory:
    db = get_database()
    async for session in db.get_session():  # –í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é
        try:
            factory = UseCaseFactory(session=session)
            yield factory
        finally:
            pass
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**:
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–µ—Å—Å–∏—é
- –ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ `get_readonly_use_case_factory()` —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
- –ù–∞—Ä—É—à–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–π —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏

**–†–µ—à–µ–Ω–∏–µ**:
–î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `session` –≤ `get_readonly_use_case_factory`, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–µ—Ä–µ–¥–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–µ—Å—Å–∏—é.

---

### üü° –ü–†–û–ë–õ–ï–ú–ê #4: Frontend - –æ—à–∏–±–∫–∞ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è, –Ω–æ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–µ

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `frontend/src/components/Panel/BirthdayManagement.tsx`

**–ü—Ä–æ–±–ª–µ–º–∞**:
–í `handleUpdate` (—Å—Ç—Ä–æ–∫–∞ 219) –æ—à–∏–±–∫–∞ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è (`throw error`), –Ω–æ –≤ `onSubmit` —Ñ–æ—Ä–º—ã (—Å—Ç—Ä–æ–∫–∞ 333-337) –æ—à–∏–±–∫–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∏ —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è, –±–µ–∑ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

**–ö–æ–¥**:
```typescript
// handleUpdate (—Å—Ç—Ä–æ–∫–∞ 219)
throw error // –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É

// onSubmit —Ñ–æ—Ä–º—ã (—Å—Ç—Ä–æ–∫–∞ 333-337)
try {
  await handleUpdate(bd.id)
} catch (error) {
  logger.error('[BirthdayManagement] Error in form onSubmit:', error)
  // –û—à–∏–±–∫–∞ —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é!
}
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç –æ—à–∏–±–∫—É, –µ—Å–ª–∏ –æ–Ω–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –≤ `handleUpdate`
- –û—à–∏–±–∫–∞ —Ç–µ—Ä—è–µ—Ç—Å—è –≤ –ª–æ–≥–∞—Ö

**–†–µ—à–µ–Ω–∏–µ**:
–£–±—Ä–∞—Ç—å `throw error` –∏–∑ `handleUpdate` (–æ—à–∏–±–∫–∞ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∞ —á–µ—Ä–µ–∑ `setError`), –∏–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫—É –≤ `onSubmit` –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –µ—ë —á–µ—Ä–µ–∑ `setError`.

---

### üü° –ü–†–û–ë–õ–ï–ú–ê #5: Frontend - –≤–æ–∑–º–æ–∂–Ω–∞ –≥–æ–Ω–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–∞

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `frontend/src/components/Panel/BirthdayManagement.tsx`

**–ü—Ä–æ–±–ª–µ–º–∞**:
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ `handleUpdate` –∏–ª–∏ `handleDelete` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `loadBirthdays()`, –Ω–æ –µ—Å–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –∏–ª–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ, —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –Ω–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–º.

**–ö–æ–¥**:
```typescript
const handleUpdate = async (id: number) => {
  // ...
  const result = await api.updateBirthday(id, normalizedData)
  setEditingId(null)
  setEditFormData({})
  loadBirthdays()  // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è, –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –ø–æ—Å–ª–µ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
}
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**:
- –ï—Å–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è `loadBirthdays()`, –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –æ—à–∏–±–∫–∞ "Can't perform a React state update on an unmounted component"
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –Ω–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–º

**–†–µ—à–µ–Ω–∏–µ**:
–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useEffect` —Å cleanup –¥–ª—è –æ—Ç–º–µ–Ω—ã –∑–∞–ø—Ä–æ—Å–æ–≤.

---

### üü° –ü–†–û–ë–õ–ï–ú–ê #6: Backend - `require_panel_access` –Ω–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–µ—Å—Å–∏—é

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `backend/src/presentation/web/routes/api.py` - —Ñ—É–Ω–∫—Ü–∏—è `require_panel_access`

**–ü—Ä–æ–±–ª–µ–º–∞**:
`require_panel_access` –≤—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é —á–µ—Ä–µ–∑ `get_readonly_use_case_factory()`, –¥–∞–∂–µ –µ—Å–ª–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∑–∞–ø—Ä–æ—Å–∞ —É–∂–µ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è —Å–µ—Å—Å–∏—è.

**–ö–æ–¥**:
```python
async def require_panel_access(
    user: dict = Depends(verify_telegram_auth),
    factory: UseCaseFactory = Depends(get_readonly_use_case_factory),  # –í—Å–µ–≥–¥–∞ –Ω–æ–≤–∞—è —Å–µ—Å—Å–∏—è
) -> dict:
    # ...
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**:
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É —Å–µ—Å—Å–∏—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∏ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ù–∞—Ä—É—à–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–π —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏

**–†–µ—à–µ–Ω–∏–µ**:
–ò–∑–º–µ–Ω–∏—Ç—å `require_panel_access` —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω –ø—Ä–∏–Ω–∏–º–∞–ª –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é —Å–µ—Å—Å–∏—é –∏–ª–∏ —Ñ–∞–±—Ä–∏–∫—É –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä.

---

### üü¢ –ü–†–û–ë–õ–ï–ú–ê #7: Frontend - –≤–æ–∑–º–æ–∂–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –∫–ª—é—á–∞–º–∏ React

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `frontend/src/components/Panel/BirthdayManagement.tsx` - —Å—Ç—Ä–æ–∫–∞ 317

**–ü—Ä–æ–±–ª–µ–º–∞**:
–í `birthdays.map((bd) => (...))` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `key={bd.id}`, –Ω–æ –µ—Å–ª–∏ `bd.id` –º–æ–∂–µ—Ç –±—ã—Ç—å `undefined` –∏–ª–∏ `null`, React –º–æ–∂–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–∞.

**–ö–æ–¥**:
```typescript
{birthdays.map((bd) => (
  <li key={bd.id} className="panel-list-item">  // bd.id –º–æ–∂–µ—Ç –±—ã—Ç—å undefined?
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**:
- React –º–æ–∂–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å DOM –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–∞
- –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∂–µ—Ç "–ø—Ä–∏–ª–∏–ø–Ω—É—Ç—å" –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É

**–†–µ—à–µ–Ω–∏–µ**:
–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å –∫–∞–∫ fallback: `key={bd.id ?? `birthday-${index}`}`

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–±–ª–æ–∫–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É):
1. **–ü–†–û–ë–õ–ï–ú–ê #1**: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –ë–î - —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏—á–∏–Ω–æ–π —Ç–æ–≥–æ, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
2. **–ü–†–û–ë–õ–ï–ú–ê #2**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π - –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–≤–ª–∏—è–µ—Ç –Ω–∞ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å):
3. **–ü–†–û–ë–õ–ï–ú–ê #3**: `get_readonly_use_case_factory` —Å–æ–∑–¥–∞—ë—Ç —Å–≤–æ—é —Å–µ—Å—Å–∏—é
4. **–ü–†–û–ë–õ–ï–ú–ê #6**: `require_panel_access` –Ω–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–µ—Å—Å–∏—é

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—É–ª—É—á—à–∞–µ—Ç UX):
5. **–ü–†–û–ë–õ–ï–ú–ê #4**: –û—à–∏–±–∫–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ —Ñ–æ—Ä–º–µ
6. **–ü–†–û–ë–õ–ï–ú–ê #5**: –í–æ–∑–º–æ–∂–Ω–∞ –≥–æ–Ω–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–∞

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞):
7. **–ü–†–û–ë–õ–ï–ú–ê #7**: –í–æ–∑–º–æ–∂–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –∫–ª—é—á–∞–º–∏ React

---

## –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –®–∞–≥ 1: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–µ—Å—Å–∏–π –ë–î
- –ò–∑–º–µ–Ω–∏—Ç—å `get_readonly_use_case_factory` —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω –º–æ–≥ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–µ—Å—Å–∏—é
- –ò–∑–º–µ–Ω–∏—Ç—å `require_panel_access` —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω –º–æ–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–µ—Å—Å–∏—é
- –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ `update_birthday` –∏ `delete_birthday`, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É —Å–µ—Å—Å–∏—é

### –®–∞–≥ 2: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –Ω–∞ frontend
- –£–±—Ä–∞—Ç—å `throw error` –∏–∑ `handleUpdate` –∏–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫—É –≤ `onSubmit`
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –≤ `loadBirthdays`

### –®–∞–≥ 3: –£–ª—É—á—à–∏—Ç—å –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å frontend
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ `bd.id` –≤ –∫–ª—é—á–∞—Ö React
- –î–æ–±–∞–≤–∏—Ç—å cleanup –¥–ª—è –æ—Ç–º–µ–Ω—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –ü–æ—á–µ–º—É –∑–∞–ø—Ä–æ—Å—ã –º–æ–≥—É—Ç –Ω–µ –¥–æ—Ö–æ–¥–∏—Ç—å –¥–æ backend?
–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å—ã PUT/DELETE –Ω–µ –¥–æ—Ö–æ–¥—è—Ç –¥–æ backend middleware (–Ω–µ—Ç –ª–æ–≥–æ–≤ `[REQUEST]`), –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
1. **CORS –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å** - –±—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å –¥–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
2. **Frontend –≤–∞–ª–∏–¥–∞—Ü–∏—è –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É** - —Ñ–æ—Ä–º–∞ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ –∑–∞–ø—Ä–æ—Å –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è
3. **JavaScript –æ—à–∏–±–∫–∞** - –æ—à–∏–±–∫–∞ –≤ `fetchWithErrorHandling` –∏–ª–∏ `api.updateBirthday`/`api.deleteBirthday` –¥–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞
4. **–ü—Ä–æ–±–ª–µ–º–∞ —Å —Å–µ—Ç—å—é** - –∑–∞–ø—Ä–æ—Å –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ç–∏ (firewall, proxy)

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –¥–æ—Ö–æ–¥–∏—Ç –ª–∏ –∑–∞–ø—Ä–æ—Å –¥–æ backend?
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (Console) –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Network tab –≤ DevTools - –≤–∏–¥–µ–Ω –ª–∏ –∑–∞–ø—Ä–æ—Å PUT/DELETE
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ backend - –µ—Å—Ç—å –ª–∏ —Ö–æ—Ç—è –±—ã OPTIONS –∑–∞–ø—Ä–æ—Å (preflight)
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ - —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –ª–∏ PUT/DELETE –º–µ—Ç–æ–¥—ã

---

## –í—ã–≤–æ–¥—ã

–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ - **–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –ë–î –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ**. –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ —Ç–æ–º—É, —á—Ç–æ:
- –û–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ –æ–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏
- –ö–æ–º–º–∏—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –¥—Ä—É–≥–æ–π —Å–µ—Å—Å–∏–∏
- –ò–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ—Ä—è—é—Ç—Å—è
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –Ω–∞—Ä—É—à–µ–Ω–∞

–≠—Ç–æ –º–æ–∂–µ—Ç –æ–±—ä—è—Å–Ω–∏—Ç—å, –ø–æ—á–µ–º—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ "–Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç" - –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è, –Ω–æ –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å–µ—Å—Å–∏—é, –∏–ª–∏ –∫–æ–º–º–∏—Ç–∏—Ç—å—Å—è –≤ —Å–µ—Å—Å–∏—é, –≥–¥–µ –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–µ –±—ã–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞.

