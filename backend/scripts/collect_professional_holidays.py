#!/usr/bin/env python3
"""
Скрипт для сбора данных о профессиональных праздниках России.

Собирает данные из известных источников и сохраняет в JSON файл.
Формат: {"MM-DD": [{"name": "...", "description": "..."}, ...]}
"""

import json
import sys
from pathlib import Path
from datetime import date

# Добавляем путь к src для импорта
sys.path.insert(0, str(Path(__file__).parent.parent / "src"))

# Базовый набор профессиональных праздников России
# Формат: (месяц, день, название, описание)
PROFESSIONAL_HOLIDAYS = [
    # Январь
    (1, 12, "День работника прокуратуры Российской Федерации", "Профессиональный праздник работников прокуратуры"),
    (1, 21, "День инженерных войск", "Профессиональный праздник военнослужащих инженерных войск"),
    (1, 25, "День студента (Татьянин день)", "Праздник российского студенчества"),
    
    # Февраль
    (2, 8, "День российской науки", "Профессиональный праздник научных работников"),
    (2, 10, "День дипломатического работника", "Профессиональный праздник дипломатов"),
    (2, 17, "День службы горючего Вооруженных Сил РФ", "Профессиональный праздник военнослужащих службы горючего"),
    (2, 23, "День защитника Отечества", "Праздник военнослужащих и всех защитников Родины"),
    (2, 27, "День Сил специальных операций", "Профессиональный праздник военнослужащих ССО"),
    
    # Март
    (3, 1, "День эксперта-криминалиста МВД России", "Профессиональный праздник экспертов-криминалистов"),
    (3, 6, "День работников геодезии и картографии", "Профессиональный праздник геодезистов и картографов"),
    (3, 8, "Международный женский день", "Праздник всех женщин"),
    (3, 11, "День работника органов наркоконтроля", "Профессиональный праздник сотрудников наркоконтроля"),
    (3, 12, "День работников уголовно-исполнительной системы", "Профессиональный праздник сотрудников УИС"),
    (3, 15, "День работников бытового обслуживания населения", "Профессиональный праздник работников сферы услуг"),
    (3, 18, "День работника налоговых органов", "Профессиональный праздник налоговых инспекторов"),
    (3, 19, "День моряка-подводника", "Профессиональный праздник подводников"),
    (3, 23, "День работников гидрометеорологической службы", "Профессиональный праздник метеорологов"),
    (3, 25, "День работника культуры", "Профессиональный праздник работников культуры"),
    (3, 27, "День войск национальной гвардии", "Профессиональный праздник военнослужащих Росгвардии"),
    (3, 29, "День специалиста юридической службы", "Профессиональный праздник военных юристов"),
    
    # Апрель
    (4, 2, "День единения народов", "Праздник единения народов Беларуси и России"),
    (4, 7, "День геолога", "Профессиональный праздник геологов"),
    (4, 8, "День сотрудников военных комиссариатов", "Профессиональный праздник военкоматов"),
    (4, 12, "День космонавтики", "Праздник работников космической отрасли"),
    (4, 15, "День специалиста по радиоэлектронной борьбе", "Профессиональный праздник специалистов РЭБ"),
    (4, 17, "День ветеранов органов внутренних дел", "Праздник ветеранов МВД"),
    (4, 18, "День воинской славы России", "Праздник в честь победы на Чудском озере"),
    (4, 21, "День местного самоуправления", "Профессиональный праздник работников муниципалитетов"),
    (4, 26, "День нотариуса", "Профессиональный праздник нотариусов"),
    (4, 27, "День российского парламентаризма", "Праздник депутатов и работников парламента"),
    (4, 28, "День работников скорой медицинской помощи", "Профессиональный праздник медиков скорой помощи"),
    (4, 30, "День пожарной охраны", "Профессиональный праздник пожарных"),
    
    # Май
    (5, 1, "Праздник Весны и Труда", "Праздник всех трудящихся"),
    (5, 5, "День шифровальщика", "Профессиональный праздник криптографов"),
    (5, 7, "День радио", "Профессиональный праздник работников связи"),
    (5, 8, "День работников Федеральной службы по военно-техническому сотрудничеству", "Профессиональный праздник работников ФСВТС"),
    (5, 12, "День экологического образования", "Праздник экологов и работников образования"),
    (5, 13, "День Черноморского флота", "Профессиональный праздник моряков ЧФ"),
    (5, 15, "День кадрового работника", "Профессиональный праздник HR-специалистов"),
    (5, 17, "День информационного общества", "Праздник IT-специалистов"),
    (5, 18, "День Балтийского флота", "Профессиональный праздник моряков БФ"),
    (5, 20, "День Волги", "Праздник работников водного транспорта"),
    (5, 21, "День полярника", "Профессиональный праздник полярников"),
    (5, 24, "День кадровика", "Профессиональный праздник работников кадровых служб"),
    (5, 25, "День филолога", "Профессиональный праздник филологов"),
    (5, 26, "День российского предпринимательства", "Праздник предпринимателей"),
    (5, 27, "День библиотекаря", "Профессиональный праздник библиотекарей"),
    (5, 28, "День пограничника", "Профессиональный праздник пограничников"),
    (5, 29, "День военного автомобилиста", "Профессиональный праздник военных водителей"),
    (5, 31, "День российской адвокатуры", "Профессиональный праздник адвокатов"),
    
    # Июнь
    (6, 1, "День Северного флота", "Профессиональный праздник моряков СФ"),
    (6, 5, "День эколога", "Профессиональный праздник экологов"),
    (6, 6, "День русского языка", "Праздник филологов и лингвистов"),
    (6, 8, "День социального работника", "Профессиональный праздник социальных работников"),
    (6, 12, "День России", "Государственный праздник"),
    (6, 14, "День работника миграционной службы", "Профессиональный праздник работников миграционной службы"),
    (6, 20, "День специалиста минно-торпедной службы", "Профессиональный праздник специалистов МТС"),
    (6, 21, "День кинологических подразделений МВД", "Профессиональный праздник кинологов"),
    (6, 22, "День памяти и скорби", "День начала Великой Отечественной войны"),
    (6, 23, "День балалайки", "Праздник музыкантов"),
    (6, 27, "День молодежи", "Праздник молодежи"),
    (6, 29, "День партизан и подпольщиков", "Праздник партизан"),
    
    # Июль
    (7, 1, "День работника морского и речного флота", "Профессиональный праздник моряков"),
    (7, 2, "День работников морского и речного флота", "Профессиональный праздник речников"),
    (7, 3, "День ГАИ (ГИБДД)", "Профессиональный праздник инспекторов ГИБДД"),
    (7, 7, "День работников морского и речного флота", "Профессиональный праздник моряков"),
    (7, 8, "День семьи, любви и верности", "Праздник семьи"),
    (7, 10, "День воинской славы России", "Праздник в честь победы под Полтавой"),
    (7, 11, "День рыбака", "Профессиональный праздник рыбаков"),
    (7, 12, "День почты", "Профессиональный праздник почтальонов"),
    (7, 17, "День авиации Военно-морского флота", "Профессиональный праздник морских авиаторов"),
    (7, 20, "День металлурга", "Профессиональный праздник металлургов"),
    (7, 24, "День кадастрового инженера", "Профессиональный праздник кадастровых инженеров"),
    (7, 25, "День сотрудника органов следствия", "Профессиональный праздник следователей"),
    (7, 26, "День парашютиста", "Профессиональный праздник парашютистов"),
    (7, 28, "День PR-специалиста", "Профессиональный праздник PR-менеджеров"),
    (7, 29, "День Военно-Морского Флота", "Профессиональный праздник моряков"),
    (7, 30, "День Военно-Морского Флота", "Профессиональный праздник моряков"),
    (7, 31, "День системного администратора", "Профессиональный праздник сисадминов"),
    
    # Август
    (8, 1, "День тыла Вооруженных Сил РФ", "Профессиональный праздник военных тыловиков"),
    (8, 2, "День Воздушно-десантных войск", "Профессиональный праздник десантников"),
    (8, 6, "День железнодорожника", "Профессиональный праздник железнодорожников"),
    (8, 7, "День железнодорожных войск", "Профессиональный праздник военных железнодорожников"),
    (8, 8, "День физкультурника", "Профессиональный праздник спортсменов и тренеров"),
    (8, 9, "День воинской славы России", "Праздник в честь победы у мыса Гангут"),
    (8, 12, "День Военно-воздушных сил", "Профессиональный праздник военных летчиков"),
    (8, 13, "День строителя", "Профессиональный праздник строителей"),
    (8, 15, "День археолога", "Профессиональный праздник археологов"),
    (8, 19, "День Воздушного флота России", "Профессиональный праздник авиаторов"),
    (8, 22, "День Государственного флага РФ", "Государственный праздник"),
    (8, 23, "День воинской славы России", "Праздник в честь победы в Курской битве"),
    (8, 27, "День российского кино", "Профессиональный праздник кинематографистов"),
    (8, 28, "День шахтера", "Профессиональный праздник шахтеров"),
    
    # Сентябрь
    (9, 1, "День знаний", "Праздник учителей и учеников"),
    (9, 2, "День российской гвардии", "Профессиональный праздник гвардейцев"),
    (9, 3, "День солидарности в борьбе с терроризмом", "Памятный день"),
    (9, 4, "День специалиста по ядерному обеспечению", "Профессиональный праздник специалистов ЯО"),
    (9, 8, "День финансиста", "Профессиональный праздник финансистов"),
    (9, 9, "День дизайнера-графика", "Профессиональный праздник дизайнеров"),
    (9, 11, "День специалиста органов воспитательной работы", "Профессиональный праздник воспитателей"),
    (9, 13, "День программиста", "Профессиональный праздник программистов"),
    (9, 15, "День работников леса", "Профессиональный праздник лесников"),
    (9, 16, "День работников нефтяной и газовой промышленности", "Профессиональный праздник нефтяников и газовиков"),
    (9, 17, "День спасателя", "Профессиональный праздник спасателей"),
    (9, 20, "День рекрутера", "Профессиональный праздник рекрутеров"),
    (9, 21, "День воинской славы России", "Праздник в честь победы в Куликовской битве"),
    (9, 27, "День воспитателя", "Профессиональный праздник воспитателей детских садов"),
    (9, 28, "День работника атомной промышленности", "Профессиональный праздник атомщиков"),
    (9, 30, "День машиностроителя", "Профессиональный праздник машиностроителей"),
    
    # Октябрь
    (10, 1, "День пожилых людей", "Праздник пожилых людей"),
    (10, 4, "День космических войск", "Профессиональный праздник военнослужащих космических войск"),
    (10, 5, "День учителя", "Профессиональный праздник учителей"),
    (10, 6, "День страховщика", "Профессиональный праздник страховщиков"),
    (10, 7, "День образования штабных подразделений МВД", "Профессиональный праздник штабистов МВД"),
    (10, 8, "День командира надводного, подводного и воздушного корабля", "Профессиональный праздник командиров кораблей"),
    (10, 12, "День кадрового работника", "Профессиональный праздник HR-специалистов"),
    (10, 14, "День работника сельского хозяйства", "Профессиональный праздник аграриев"),
    (10, 20, "День военного связиста", "Профессиональный праздник военных связистов"),
    (10, 23, "День работников рекламы", "Профессиональный праздник рекламистов"),
    (10, 24, "День подразделений специального назначения", "Профессиональный праздник спецназа"),
    (10, 25, "День таможенника", "Профессиональный праздник таможенников"),
    (10, 28, "День анимации", "Профессиональный праздник аниматоров"),
    (10, 29, "День вневедомственной охраны", "Профессиональный праздник работников вневедомственной охраны"),
    (10, 30, "День инженера-механика", "Профессиональный праздник инженеров-механиков"),
    (10, 31, "День сурдопереводчика", "Профессиональный праздник сурдопереводчиков"),
    
    # Ноябрь
    (11, 1, "День менеджера", "Профессиональный праздник менеджеров"),
    (11, 4, "День народного единства", "Государственный праздник"),
    (11, 5, "День военного разведчика", "Профессиональный праздник военных разведчиков"),
    (11, 10, "День сотрудника органов внутренних дел", "Профессиональный праздник полицейских"),
    (11, 11, "День экономиста", "Профессиональный праздник экономистов"),
    (11, 12, "День работников Сбербанка", "Профессиональный праздник банковских работников"),
    (11, 13, "День войск радиационной, химической и биологической защиты", "Профессиональный праздник военнослужащих РХБЗ"),
    (11, 14, "День социолога", "Профессиональный праздник социологов"),
    (11, 15, "День призывника", "Праздник призывников"),
    (11, 17, "День участкового", "Профессиональный праздник участковых"),
    (11, 19, "День ракетных войск и артиллерии", "Профессиональный праздник артиллеристов"),
    (11, 21, "День бухгалтера", "Профессиональный праздник бухгалтеров"),
    (11, 22, "День психолога", "Профессиональный праздник психологов"),
    (11, 27, "День морской пехоты", "Профессиональный праздник морских пехотинцев"),
    (11, 28, "День матери", "Праздник матерей"),
    
    # Декабрь
    (12, 1, "День воинской славы России", "Праздник в честь победы в Синопском сражении"),
    (12, 3, "День юриста", "Профессиональный праздник юристов"),
    (12, 4, "День информатики", "Профессиональный праздник информатиков"),
    (12, 5, "День воинской славы России", "Праздник в честь начала контрнаступления под Москвой"),
    (12, 9, "День Героев Отечества", "Праздник героев"),
    (12, 10, "День создания службы связи МВД", "Профессиональный праздник связистов МВД"),
    (12, 12, "День Конституции РФ", "Государственный праздник"),
    (12, 15, "День образования радиотехнических войск", "Профессиональный праздник радиотехников"),
    (12, 17, "День Ракетных войск стратегического назначения", "Профессиональный праздник ракетчиков"),
    (12, 19, "День военной контрразведки", "Профессиональный праздник контрразведчиков"),
    (12, 20, "День работника органов безопасности", "Профессиональный праздник сотрудников ФСБ"),
    (12, 22, "День энергетика", "Профессиональный праздник энергетиков"),
    (12, 23, "День дальней авиации", "Профессиональный праздник военных летчиков"),
    (12, 27, "День спасателя", "Профессиональный праздник спасателей"),
]


def normalize_date(month: int, day: int) -> str:
    """Нормализует дату в формат MM-DD."""
    return f"{month:02d}-{day:02d}"


def collect_holidays() -> dict:
    """Собирает данные о профессиональных праздниках."""
    holidays_by_date = {}
    
    for month, day, name, description in PROFESSIONAL_HOLIDAYS:
        date_key = normalize_date(month, day)
        
        if date_key not in holidays_by_date:
            holidays_by_date[date_key] = []
        
        holidays_by_date[date_key].append({
            "name": name,
            "description": description,
        })
    
    return holidays_by_date


def main():
    """Основная функция скрипта."""
    script_dir = Path(__file__).parent
    data_dir = script_dir.parent / "data"
    output_file = data_dir / "professional_holidays.json"
    
    # Создаем директорию если не существует
    data_dir.mkdir(parents=True, exist_ok=True)
    
    # Собираем данные
    print("Сбор данных о профессиональных праздниках...")
    holidays = collect_holidays()
    
    # Сохраняем в JSON
    print(f"Сохранение данных в {output_file}...")
    with open(output_file, "w", encoding="utf-8") as f:
        json.dump(holidays, f, ensure_ascii=False, indent=2)
    
    # Статистика
    total_holidays = sum(len(v) for v in holidays.values())
    print(f"OK: Собрано {total_holidays} профессиональных праздников")
    print(f"OK: Данные сохранены в {output_file}")
    print(f"OK: Покрыто {len(holidays)} дней в году")


if __name__ == "__main__":
    main()

